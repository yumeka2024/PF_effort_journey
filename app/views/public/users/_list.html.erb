<!--app/views/public/users/_list.html.erb-->
<style>
.card:hover{
  background: #e7e9ea;
}
</style>

<div class="card-list-containar">
  <% users.each do |user| %>
  <div class="card w-100 shadow-sm m-1">
    <div class="card-body">
      <%= link_to(user_path(user), class:"text-dark link-underline-dark link-offset-2-hover link-underline-opacity-0 link-underline-opacity-100-hover") do %>
      <div class="row">
        <div class="col-2">
          <%= image_tag user.get_image(60,60), class:"rounded-circle";  %>
        </div>
        <div class="col-10 w-75">
          <p><%= user.name.truncate(30) %></p>
          <p><%= user.custom_identifier.truncate(20) %></p>
          <p><%= user.introduction.truncate(40) %></p>
        </div>
      </div>
      <% end %>
      <div class="row">
        <div class="col d-flex justify-content-evenly">
          <div>
          <% if current_user.followed?(user) %>
            <p class="border border-success rounded text-success p-2">フォローされています</p>
          <% else %>
            <p class="border border-secondary rounded text-secondary p-2">フォローされていません</p>
          <% end %>
          </div>
          <div class="follow-btn">
            <%= render "public/relationships/btn", user: user %>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col d-flex justify-content-evenly approved-btn">
          <% if user && current_user.followed?(user) && !user.active_relationships.find_by(followed_id: current_user.id).approved %>
            <%= link_to "承認する", user_relationships_path(user.custom_identifier), method: :patch, class: "btn btn-success" %>
            <%= link_to "拒否する", user_relationships_path(user.custom_identifier), method: :delete, class: "btn btn-danger" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <% end %>
</div>